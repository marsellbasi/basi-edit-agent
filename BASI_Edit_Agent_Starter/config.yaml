dataset_root: ./BASI_EDIT_AGENT
output_root: ./BASI_EDIT_AGENT
random_seed: 42

# Color model configuration
color_model:
  # which model to use at inference
  type: "unet"
  hdrnet:
    ckpt_path: "checkpoints/hdrnet_color/latest.pt"
    residual_scale: 0.30
  unet:
    input_downsample: 256
    # UNet architecture
    base_channels: 32
    num_down: 4
    use_batchnorm: true
    residual: true
    residual_scale: 0.30  # scale factor at inference (0.0â€“1.0)

# Training configuration
training:
  hdrnet_color:
    batch_size: 1
    num_workers: 0
    lr: 1.0e-4
    weight_decay: 0.0
    epochs: 20
    save_every: 1
    loss:
      l1_weight: 1.0
      ssim_weight: 0.0  # SSIM loss not implemented yet
  unet_color:
    lr: 1e-4
    weight_decay: 0.0
    batch_size: 2
    epochs: 20
    max_side: 1024
    model_dir: "checkpoints/unet_color"
    num_workers: 0
    save_every: 1
    loss:
      l1_weight: 1.0
  bg_residual:
    lr: 1e-4
    weight_decay: 0.0
    batch_size: 2
    num_workers: 0
    epochs: 20
    save_every: 1
    model_dir: "checkpoints/bg_residual_v2"
    dataset_version: "bg_v1"
    max_side: 1024
    identity_weight: 0.1
    use_mask: true
    # bg_model_version: "v1" (original) or "v2" (stronger background edits with mask-weighted residuals)
    # v2 produces more visible background changes by:
    #   - Using larger model capacity (base_ch=48 vs 32)
    #   - Applying mask-weighted residuals (full strength on bg, suppressed on subject)
    #   - Allowing stronger residual scaling (0.6 vs 0.3)
    bg_model_version: "v2"  # v2 enabled with masks for stronger background edits
    # v2-specific settings:
    bg_residual_scale: 1.0    # Residual scale for background regions (default 1.0 = full strength)
    subj_residual_scale: 0.1  # Residual scale for subject regions (default 0.1 = strongly suppressed)
    base_ch: 48               # Base channels (48 vs 32 for v1, increases model capacity)
    loss:
      l1_weight: 1.0
  skin_residual:
    lr: 1e-4
    weight_decay: 0.0
    batch_size: 4
    num_workers: 0
    epochs: 20
    save_every: 1
    model_dir: "checkpoints/skin_residual"
    dataset_version: "skin_v1"
    max_side: 1024
    identity_weight: 0.3
    loss:
      l1_weight: 1.0

# Dataset configurations
datasets:
  skin_v1:
    train_before_glob: "BASI_EDIT_AGENT/skin_v1/train/before/*.jpg"
    train_after_glob: "BASI_EDIT_AGENT/skin_v1/train/after/*.jpg"
    val_before_glob: "BASI_EDIT_AGENT/skin_v1/val/before/*.jpg"
    val_after_glob: "BASI_EDIT_AGENT/skin_v1/val/after/*.jpg"

